(()=>{"use strict";!function(){const e=new Date,t="10000000-1000-4000-8000-100000000000".replace(/[018]/g,(e=>{const t=+e;return(t^crypto.getRandomValues(new Uint8Array(1))[0]&15>>t/4).toString(16)})),o=[".price"],n=document.querySelector('script[data-id][data-name="shopifyAddiWidget"]'),r=n.getAttribute("data-element-reference"),i=n.getAttribute("data-ally-slug"),d={showBanner:!1,bannerId:"",bannerElementRef:""},a={borderColor:n.getAttribute("widget-border-color"),borderRadius:n.getAttribute("widget-border-radius"),fontColor:n.getAttribute("widget-font-color"),fontFamily:n.getAttribute("widget-font-family"),fontSize:n.getAttribute("widget-font-size"),badgeBackgroundColor:n.getAttribute("widget-badge-background-color"),infoBackgroundColor:n.getAttribute("widget-info-background-color"),iconType:n.getAttribute("widget-addi-icon-type"),iconSize:n.getAttribute("widget-addi-icon-size"),margin:n.getAttribute("widget-margin")},c={backgroundColor:n.getAttribute("modal-background-color"),fontColor:n.getAttribute("modal-font-color"),fontFamily:n.getAttribute("modal-font-family"),priceColor:n.getAttribute("modal-price-color"),badgeBackgroundColor:n.getAttribute("modal-badge-background-color"),badgeFontColor:n.getAttribute("modal-badge-font-color"),badgeBorderRadius:n.getAttribute("modal-badge-border-radius"),cardColor:n.getAttribute("modal-card-color"),buttonBorderColor:n.getAttribute("modal-button-border-color"),buttonBorderRadius:n.getAttribute("modal-button-border-radius"),buttonBackgroundColor:n.getAttribute("modal-button-background-color"),buttonFontColor:n.getAttribute("modal-button-font-color")};let u=null,l=null;const s=()=>{var e,o;e=t,o=i,l=(t="",n={})=>(({source:e,id:t,title:o,params:n,channel:r,allySlug:i})=>{const d={id:t,title:o,params:{executedAt:(new Date).toString(),...n},properties:{channel:r,allySlug:i}};return(async(e,t,o={},n={})=>{const r=`${e}${t}`;return n={method:"POST",headers:{"content-type":"application/json"},...n},await fetch(r,{...n,body:o}).then((e=>e.json())).catch((e=>e))})("https://logger.addi.com",`/api/events/${e}`,JSON.stringify(d))})({id:e,title:t,params:n,source:"ALLY_INTEGRATION_PRODUCT",channel:"E_COMMERCE_SHOPIFY",allySlug:o}).then()};function g(e){if(e)return u=document.querySelector(e),u;for(let e=0;e<o.length;e++)if(u=document.querySelector(o[e]),u)return u;return null}function m(e,t){t.parentNode.insertBefore(e,t.nextSibling)}function b(){const t=window?.meta?.page?.pageType?window?.meta?.page?.pageType:function(){const e=window.location.pathname;return"/"===e?"home":e.includes("/products")?"product":""}();if(function(e){if("home"===e){const e=document.createElement("script");e.type="module",e.src="https://cdn.addi.com/home-banner-widget/prod/v1/home-banner-widget.esm.js",document.head.append(e)}if("product"===e){const e=document.createElement("script");e.type="module",e.src="https://cdn.addi.com/product-details-widget/prod/v1/product-details-widget.esm.js",document.head.append(e)}}(t),s(),"home"===t&&(d.showBanner="true"===n.getAttribute("data-show-banner"),d.bannerElementRef=n.getAttribute("data-banner-element-reference"),d.bannerId=n.getAttribute("data-banner-id"),d.showBanner&&function(){const t=u||g(d.bannerElementRef);if(t){const o=document.querySelector("addi-home-banner");o&&o.remove();const n=document.createElement("addi-home-banner");d.bannerId&&(n.setAttribute("ally-slug",i),n.setAttribute("banner-id",d.bannerId)),m(n,t);const r=new Date;setTimeout((()=>{const t=document.querySelector("addi-home-banner");t||(console.log("Banner was NOT created"),l&&l("PDP_SCRIPT.BANNER_NOT_DISPLAYED",{onScriptInitTimeMs:e.getTime(),widgetInsertionFailedTimeMs:r.getTime()})),t?.shadowRoot?.hasChildNodes()||(console.log("Banner was NOT inserted"),l&&l("PDP_SCRIPT.BANNER_NOT_INSERTED",{onScriptInitTimeMs:e.getTime(),widgetInsertionFailedTimeMs:r.getTime()}))}),700)}else console.log("[ADDI - Home banner] No reference node was not found.")}()),"product"===t){const t=function(){const e=window?.meta?.product||{};if(e){const t=new URLSearchParams(window.location.search).get("variant");if(t){const o=e.variants.filter((e=>e.id===parseInt(t)));return o.length>0?o[0]:null}return e?.variants[0]}console.warn("[ADDI - widget] Product info not found.")}(),o=t.price/100;t?function(t){const o=g(r);if(o){const n=document.querySelector("addi-product-widget");n&&n.remove();const r=document.createElement("addi-product-widget");r.setAttribute("ally-slug",i),r.setAttribute("price",t),r.setAttribute("country","co"),r.setAttribute("custom-widget-styles",function(){const e=e=>{const t=Object.keys(e),o={};for(let n=0;n<Object.keys(e).length;n++)e[t[n]]&&(o[t[n]]=e[t[n]]);return o};return JSON.stringify({widget:e(a),modal:e(c)})}()),r.setAttribute("style","display: block;"),r.addEventListener("onWidgetClickedEvent",(()=>{l&&l("PDP_SCRIPT.WIDGET_CLICKED",{allySlug:i})})),m(r,o);const d=new Date;l&&l("PDP_SCRIPT.WIDGET_INSERTED",{allySlug:i,onScriptInitTimeMs:e.getTime(),onWdgInsertedTimeMs:d.getTime(),onWdgInsertedDurationMs:d.getTime()-e.getTime()}),setTimeout((()=>{const t=document.querySelector("addi-product-widget");t||(console.log("Widget was NOT created"),l&&l("PDP_SCRIPT.WIDGET_NOT_INSERTED",{onScriptInitTimeMs:e.getTime(),widgetInsertionFailedTimeMs:d.getTime()})),t?.shadowRoot?.hasChildNodes()||l&&l("PDP_SCRIPT.WIDGET_NOT_DISPLAYED",{onScriptInitTimeMs:e.getTime(),widgetInsertionFailedTimeMs:d.getTime()})}),7e3)}else console.log("[ADDI - Widget] No reference node was not found.")}(o):console.warn("[ADDI - widget] Product info is undefined.")}}"complete"===document.readyState||"interactive"===document.readyState?b():window.addEventListener("DOMContentLoaded",b),window.addEventListener("change",(()=>{setTimeout(b,500)}))}()})();